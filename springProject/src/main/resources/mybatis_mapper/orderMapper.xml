<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.group3.springProject.mapper.OrderMapper">
	<resultMap type="OrderSheet" id="OrderSheetMap">
	<id column="order_no" property="order_no"/>
	<result column="order_type" property="order_type"/>
	<result column="order_time" property="order_time"/>
		<association property="user" javaType="User" foreignColumn="user_id">
			<id column="user_id" property="user_id"/>
			<result column="user_name" property="user_name"/>	
			<result column="user_phone" property="user_phone"/>	
			<result column="user_email" property="user_email"/>	
			<result column="user_addr_postcode" property="user_addr_postcode"/>	
			<result column="user_addr_main" property="user_addr_main"/>	
			<result column="user_addr_detail" property="user_addr_detail"/>	
			<result column="user_addr_extra" property="user_addr_extra"/>	
		</association>
		<association property="product" javaType="Product" foreignColumn="prod_id">
			<id column="prod_id" property="prod_id"/>
			<result column="prod_name" property="prod_name"/>
			<result column="prod_price" property="prod_price"/>
			<result column="category_code" property="category_code"/>
			<result column="prod_img" property="prod_img"/>
			<result column="division_code" property="division_code"/>
			<result column="shipping_id" property="prod_name"/>
			<result column="prod_name" property="shipping_id"/>
		</association>
	</resultMap>
	
	<select id="selectByUserId" resultMap="OrderSheetMap">
	SELECT o.*, u.*, p.prod_id, p.prod_name
	
	FROM ORDERSHEET o 
	
	LEFT JOIN USER u USING (user_id) 
	LEFT JOIN PRODUCT p USING (prod_id) 
	
	WHERE o.user_id=#{userId}
	</select>

</mapper>